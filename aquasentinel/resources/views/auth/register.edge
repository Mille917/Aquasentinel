<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Register</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
  <link rel="stylesheet" href="/build1/css/demo.css" rel="stylesheet"/>
  <link rel="stylesheet" href="/phone1/css/intlTelInput.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
</head>

<body class="bg-gray-100 min-h-screen flex flex-col">

  <!-- Navbar -->
  <nav class="bg-white shadow">
    <div class="container mx-auto px-4 py-4">
      <a href="/publicDashboard" class="text-xl font-bold text-blue-600">Aquasentinel</a>
    </div>
  </nav>

  <!-- Main content -->
  <main class="flex-grow flex items-center justify-center px-4 py-8">
    <div class="w-full max-w-md bg-white p-6 rounded shadow">
      <h1 class="text-2xl font-bold text-center mb-6">Create an Account</h1>

      <form action="/register" method="POST" enctype="multipart/form-data">
        {{ csrfField() }}

        <!-- Basic Fields -->
        <div class="space-y-4">
          <div>
            <label class="block font-semibold mb-1" for="firstName">First Name</label>
            <input class="w-full border px-3 py-2 rounded" type="text" id="firstName" name="firstName" required />
          </div>

          <div>
            <label class="block font-semibold mb-1" for="lastName">Last Name</label>
            <input class="w-full border px-3 py-2 rounded" type="text" id="lastName" name="lastName" required />
          </div>

          <div>
            <label class="block font-semibold mb-1" for="username">Username</label>
            <input class="w-full border px-3 py-2 rounded" type="text" id="username" name="username" required />
          </div>

          <div>
            <label class="block font-semibold mb-1" for="email">Email</label>
            <input class="w-full border px-3 py-2 rounded" type="email" id="email" name="email" required />
          </div>

          <div class="relative">
            <label class="block font-semibold mb-1" for="password">Password</label>
            <input class="w-full border px-3 py-2 rounded pr-10" type="password" id="password" name="password"
              required />
            <span id="togglePassword" class="absolute right-3 top-9 cursor-pointer text-gray-600">
              <i class="fas fa-eye"></i>
            </span>
          </div>

          <div>
            <label class="block font-semibold mb-1" for="role">Role</label>
            <select class="w-full border px-3 py-2 rounded" id="role" name="role" required onchange="showProofFields()">
              <option value="">Select Role</option>
              <option value="admin">Admin</option>
              <option value="moderator">Moderator</option>
              <option value="citizen">Citizen</option>
            </select>
          </div>

          <!-- Proof Fields (Hidden initially) -->
          <div id="admin-proof" class="hidden space-y-2">
            <label class="block font-semibold" for="admin_type">Admin Type</label>
            <select id="admin_type" name="admin_type" class="w-full border px-3 py-2 rounded"
              onchange="showAdminProofFields()">
              <option value="">Select Admin Type</option>
              <option value="government">Government Admin</option>
              <option value="other">Other Admin</option>
            </select>

            <div id="government-admin-fields" class="hidden">
              <label class="block" for="gov_id_card">Gov ID (PDF/Image)</label>
              <input type="file" id="gov_id_card" name="gov_id_card" accept=".pdf,image/*"
                class="w-full border px-3 py-2 rounded" />
              <label class="block mt-2" for="gov_fingerprint">Digital Fingerprint</label>
              <input type="file" id="gov_fingerprint" name="gov_fingerprint" accept="image/*"
                class="w-full border px-3 py-2 rounded" />
            </div>
          </div>

          <div id="moderator-proof" class="hidden space-y-2">
            <label for="moderator_name">Business Name</label>
            <input type="text" id="moderator_name" name="moderator_name" class="w-full border px-3 py-2 rounded" />
            <label for="moderator_rccm">RCCM Proof</label>
            <input type="file" id="moderator_rccm" name="moderator_rccm" accept=".pdf,image/*"
              class="w-full border px-3 py-2 rounded" />
          </div>

          <div id="citizen-proof" class="hidden space-y-2">
            <label for="citizen_id_card">National ID (PDF/Image)</label>
            <input type="file" id="citizen_id_card" name="citizen_id_card" accept=".pdf,image/*"
              class="w-full border px-3 py-2 rounded" />
            <p class="text-xs text-gray-500">You must be at least 14 years old.</p>
          </div>

          <div class="relative">
            <label class="block font-semibold mb-1" for="phone_number">Phone Number</label>
            <input class="w-full border px-3 py-2 rounded" type="tel" id="phone_number" name="phone_number"
              placeholder="e.g. +243 812345678" required />
            <p class="text-xs text-gray-500">Write your country code and your phone nume.</p>
          </div>

          <div>
            <label class="block font-semibold mb-1" for="country">Country</label>
            <select id="country" name="country" required class="w-full border px-3 py-2 rounded">
              <option value="">Select your country</option>
              <option value="AF">Afghanistan</option>
              <option value="AL">Albania</option>
              <option value="DZ">Algeria</option>
              <option value="AO">Angola</option>
              <option value="AR">Argentina</option>
              <option value="AM">Armenia</option>
              <option value="AU">Australia</option>
              <option value="AT">Austria</option>
              <option value="AZ">Azerbaijan</option>
              <option value="BD">Bangladesh</option>
              <option value="BE">Belgium</option>
              <option value="BJ">Benin</option>
              <option value="BR">Brazil</option>
              <option value="BG">Bulgaria</option>
              <option value="BF">Burkina Faso</option>
              <option value="BI">Burundi</option>
              <option value="CM">Cameroon</option>
              <option value="CA">Canada</option>
              <option value="CF">Central African Republic</option>
              <option value="TD">Chad</option>
              <option value="CL">Chile</option>
              <option value="CN">China</option>
              <option value="CO">Colombia</option>
              <option value="CG">Congo</option>
              <option value="CD">Congo (DRC)</option>
              <option value="CI">CÃ´te d'Ivoire</option>
              <option value="HR">Croatia</option>
              <option value="CZ">Czech Republic</option>
              <option value="DK">Denmark</option>
              <option value="EG">Egypt</option>
              <option value="ET">Ethiopia</option>
              <option value="FI">Finland</option>
              <option value="FR">France</option>
              <option value="GA">Gabon</option>
              <option value="GM">Gambia</option>
              <option value="DE">Germany</option>
              <option value="GH">Ghana</option>
              <option value="GR">Greece</option>
              <option value="IN">India</option>
              <option value="ID">Indonesia</option>
              <option value="IR">Iran</option>
              <option value="IQ">Iraq</option>
              <option value="IE">Ireland</option>
              <option value="IL">Israel</option>
              <option value="IT">Italy</option>
              <option value="JP">Japan</option>
              <option value="KE">Kenya</option>
              <option value="KR">Korea</option>
              <option value="LB">Lebanon</option>
              <option value="LY">Libya</option>
              <option value="MG">Madagascar</option>
              <option value="MW">Malawi</option>
              <option value="MY">Malaysia</option>
              <option value="ML">Mali</option>
              <option value="MA">Morocco</option>
              <option value="MZ">Mozambique</option>
              <option value="NA">Namibia</option>
              <option value="NP">Nepal</option>
              <option value="NL">Netherlands</option>
              <option value="NG">Nigeria</option>
              <option value="NO">Norway</option>
              <option value="PK">Pakistan</option>
              <option value="PH">Philippines</option>
              <option value="PL">Poland</option>
              <option value="PT">Portugal</option>
              <option value="RO">Romania</option>
              <option value="RU">Russia</option>
              <option value="RW">Rwanda</option>
              <option value="SA">Saudi Arabia</option>
              <option value="SN">Senegal</option>
              <option value="RS">Serbia</option>
              <option value="SL">Sierra Leone</option>
              <option value="ZA">South Africa</option>
              <option value="SS">South Sudan</option>
              <option value="ES">Spain</option>
              <option value="SE">Sweden</option>
              <option value="CH">Switzerland</option>
              <option value="SY">Syria</option>
              <option value="TZ">Tanzania</option>
              <option value="TH">Thailand</option>
              <option value="TG">Togo</option>
              <option value="TN">Tunisia</option>
              <option value="TR">Turkey</option>
              <option value="UG">Uganda</option>
              <option value="UA">Ukraine</option>
              <option value="AE">United Arab Emirates</option>
              <option value="GB">United Kingdom</option>
              <option value="US">United States</option>
              <option value="VN">Vietnam</option>
              <option value="YE">Yemen</option>
              <option value="ZM">Zambia</option>
              <option value="ZW">Zimbabwe</option>
            </select>
          </div>

          <div class="mb-4">
            <label class="block mb-1 font-semibold" for="region">Region</label>
            <input class="w-full border px-3 py-2 rounded" type="text" id="region" name="region"
              placeholder="e.g. Kinshasa" required />
          </div>

        </div>
        <button type="submit" class="w-full bg-blue-600 text-white py-2 rounded font-semibold hover:bg-blue-700 mt-6">
          Register
        </button>

        <p class="text-center text-gray-600 mt-4 text-sm">
          Already have an account?
          <a href="/login" class="text-blue-600 hover:underline">Log in</a>
        </p>
      </form>
    </div>
  </main>

  <!-- Footer -->
  <footer class="bg-gray-800 text-white text-center py-4">
    <p>&copy; {{ new Date().getFullYear() }} Aquasentinel. All rights reserved.</p>
  </footer>

  <!-- Scripts -->
  <script>
    const togglePassword = document.getElementById('togglePassword')
    const passwordInput = document.getElementById('password')
    const icon = togglePassword.querySelector('i')

    togglePassword.addEventListener('click', () => {
      const isPassword = passwordInput.getAttribute('type') === 'password'
      passwordInput.setAttribute('type', isPassword ? 'text' : 'password')
      icon.classList.toggle('fa-eye')
      icon.classList.toggle('fa-eye-slash')
    })

    function showProofFields() {
      const role = document.getElementById('role').value
      document.getElementById('admin-proof').classList.add('hidden')
      document.getElementById('moderator-proof').classList.add('hidden')
      document.getElementById('citizen-proof').classList.add('hidden')

      if (role === 'admin') {
        document.getElementById('admin-proof').classList.remove('hidden')
        showAdminProofFields()
      } else if (role === 'moderator') {
        document.getElementById('moderator-proof').classList.remove('hidden')
      } else if (role === 'citizen') {
        document.getElementById('citizen-proof').classList.remove('hidden')
      }
    }

    function showAdminProofFields() {
      const type = document.getElementById('admin_type').value
      document.getElementById('government-admin-fields').classList.toggle('hidden', type !== 'government')
    }
  </script>

  <script src="/build1/js/intlTelInput.js"></script>
  <script>
   const input = document.querySelector("#phone_number");
window.intlTelInput(input, {
  initialCountry: "auto",
  geoIpLookup: function (callback) {
    fetch('https://ipapi.co/json')
      .then(res => res.json())
      .then(data => callback(data.country_code))
      .catch(() => callback('us'));
  },
  utilsScript: "/phone1/js/utils.js", // Needed for formatting/validation
});
  </script>
</body>

</html>